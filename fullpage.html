<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Heygen — Full Page (Dark)</title>
  <meta name="color-scheme" content="dark">

  <style>
    /* ====== Dark base, full viewport ====== */
    :root {
      color-scheme: dark;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #0b0b0f;   /* very dark */
      color: #e6e6f0;         /* soft light text */
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    }

    /* ====== Force Heygen to cover the whole page ======
       We override their default bottom-left floating bubble. */
    #heygen-streaming-embed,
    #heygen-streaming-embed.expand {
      position: fixed !important;
      inset: 0 !important;          /* top/right/bottom/left = 0 */
      width: 100vw !important;
      height: 100vh !important;
      transform: none !important;
      border: 0 !important;
      border-radius: 0 !important;
      box-shadow: none !important;
      opacity: 1 !important;
      visibility: visible !important;
      z-index: 9999 !important;
      background: #0b0b0f;          /* match page background */
    }

    /* Ensure inner container/iframe stretch fully */
    #heygen-streaming-container {
      width: 100% !important;
      height: 100% !important;
    }
    #heygen-streaming-container iframe {
      width: 100% !important;
      height: 100% !important;
      border: 0 !important;
      display: block;
      background: #0b0b0f;
    }

    /* Hint kecil (akan hilang sendiri) */
    #hint {
      position: fixed;
      left: 50%;
      bottom: 20px;
      transform: translateX(-50%);
      padding: 10px 14px;
      font-size: 12px;
      background: rgba(255,255,255,0.08);
      color: #e6e6f0;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 8px;
      opacity: .92;
      z-index: 10000;
      pointer-events: none;
      transition: opacity .4s ease;
    }
  </style>
</head>
<body>
  <div id="hint">Double‑click untuk fullscreen • Tekan <kbd>F</kbd> untuk toggle • <kbd>Esc</kbd> keluar</div>

  <script>
    (function () {
      const host = "https://labs.heygen.com";
      const url =
        host +
        "/guest/streaming-embed?share=eyJxdWFsaXR5IjoiaGlnaCIsImF2YXRhck5hbWUiOiJUaGFkZGV1c19Qcm9mZXNzaW9uYWxMb29r%0D%0AX3B1YmxpYyIsInByZXZpZXdJbWciOiJodHRwczovL2ZpbGVzMi5oZXlnZW4uYWkvYXZhdGFyL3Yz%0D%0ALzhkYzJjYWExNzJjZDRlNjc5NmIzN2U5ZjE2OTU0YjdlXzU1OTUwL3ByZXZpZXdfdGFyZ2V0Lndl%0D%0AYnAiLCJuZWVkUmVtb3ZlQmFja2dyb3VuZCI6dHJ1ZSwia25vd2xlZGdlQmFzZUlkIjoiZGVtby0x%0D%0AIiwidXNlcm5hbWUiOiJlMGQ4NDZlMDQ4NjY0NjJmOWNlMjBmMWFjNDYwODAxZiJ9&inIFrame=1";

      // Buat struktur default yang Heygen harapkan (tanpa div tambahan dari kita)
      const wrapDiv = document.createElement("div");
      wrapDiv.id = "heygen-streaming-embed";

      const container = document.createElement("div");
      container.id = "heygen-streaming-container";

      const stylesheet = document.createElement("style");
      // Biarkan default CSS mereka (akan di-override oleh CSS global kita di atas)
      stylesheet.innerHTML = `
        #heygen-streaming-embed {
          z-index: 9999;
          position: fixed;
          left: 40px;
          bottom: 40px;
          width: 200px;
          height: 200px;
          border-radius: 50%;
          border: 2px solid #fff;
          box-shadow: 0px 8px 24px 0px rgba(0, 0, 0, 0.12);
          transition: all linear 0.1s;
          overflow: hidden;
          opacity: 0;
          visibility: hidden;
        }
        #heygen-streaming-embed.show { opacity: 1; visibility: visible; }
        #heygen-streaming-embed.expand {
          height: 366px;
          width: calc(366px * 16 / 9);
          border: 0;
          border-radius: 8px;
        }
        #heygen-streaming-container { width: 100%; height: 100%; }
        #heygen-streaming-container iframe { width: 100%; height: 100%; border: 0; }
      `;

      const iframe = document.createElement("iframe");
      iframe.title = "Streaming Embed";
      iframe.role = "dialog";
      iframe.allow = "microphone";     // Heygen needs mic access
      iframe.src = url;

      // Enable fullscreen capability on init (dan juga sekarang)
      iframe.setAttribute("allowfullscreen", "");
      iframe.allowFullscreen = true;

      // Dengarkan event dari Heygen
      window.addEventListener("message", (e) => {
        if (e.origin !== host || !e.data || e.data.type !== "streaming-embed") return;

        if (e.data.action === "init") {
          wrapDiv.classList.add("show");
          // Sembunyikan hint setelah beberapa detik
          const hint = document.getElementById("hint");
          if (hint) setTimeout(() => {
            hint.style.opacity = 0; setTimeout(() => hint.remove(), 500);
          }, 3500);
        } else if (e.data.action === "show") {
          wrapDiv.classList.add("expand");
        } else if (e.data.action === "hide") {
          wrapDiv.classList.remove("expand");
        }
      });

      // ====== Fullscreen controls (opsional) ======
      function enterFS(el) {
        if (!document.fullscreenElement && el.requestFullscreen) el.requestFullscreen();
      }
      function exitFS() {
        if (document.fullscreenElement && document.exitFullscreen) document.exitFullscreen();
      }
      // Double‑click area video untuk fullscreen
      wrapDiv.addEventListener("dblclick", () => enterFS(wrapDiv));
      // Tombol 'F' untuk toggle fullscreen
      document.addEventListener("keydown", (ev) => {
        if (ev.key.toLowerCase() === "f") {
          if (document.fullscreenElement) exitFS(); else enterFS(wrapDiv);
        }
      });

      // Mount ke body
      container.appendChild(iframe);
      wrapDiv.appendChild(stylesheet);
      wrapDiv.appendChild(container);
      document.body.appendChild(wrapDiv);
    })();
  </script>
</body>
</html>
